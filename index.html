<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mama's Pizza Shop</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600&display=swap');
    :root {
      --brand:#e53935; --brand-dark:#c62828;
      --accent:#ffca28; --bg:#fff3e0; --card:#fff; --ok:#2e7d32; --muted:#6b7280;
    }
    *{box-sizing:border-box}
    body{
      font-family:'Baloo 2',cursive;
      background:linear-gradient(135deg,#ffe0b2 0%,#ffcc80 100%);
      margin:0;color:#333;
    }
    header{
      background:var(--brand);
      color:#fff;
      text-align:center;
      padding:24px;
      font-size:32px;
      font-weight:700;
      letter-spacing:1px;
      box-shadow:0 4px 10px rgba(0,0,0,.25);
    }
    .container{
      max-width:1000px;
      margin:24px auto;
      background:var(--card);
      padding:28px;
      border-radius:20px;
      box-shadow:0 6px 18px rgba(0,0,0,.15);
    }
    h2,h3{color:var(--brand-dark);text-align:center;margin-bottom:20px}
    .grid{display:grid;gap:18px;margin-top:20px;}
    .pizza-section{
      border:2px solid var(--accent);
      border-radius:16px;
      padding:16px;
      background:var(--bg);
    }
    .preview-wrap{display:grid;grid-template-columns:1fr 1fr;gap:18px;align-items:center}
    @media(max-width:800px){.preview-wrap{grid-template-columns:1fr}}
    .stage{
      margin:auto;
      position:relative;
      overflow:hidden;
      transition: all 0.3s ease;
      border-radius:50%;
      background:#fff;
    }
    .layer{
      position:absolute;inset:0;
      object-fit:contain;width:100%;height:100%;
      display:none;
    }
    .controls label{display:block;margin:6px 0}
    select,input[type="number"],input[type="text"],textarea{
      width:100%;padding:10px;
      border:2px solid #ddd;border-radius:10px;
      font-size:16px;font-family:'Baloo 2',cursive
    }
    textarea{resize:none}
    .total{margin-top:20px;font-size:24px;font-weight:700;text-align:center;color:var(--ok)}
    .btn{
      display:block;width:100%;padding:14px;
      background:var(--brand);color:#fff;
      font-size:20px;font-weight:600;border:0;border-radius:12px;cursor:pointer;
      margin-top:20px;transition:.3s;
    }
    .btn:hover{background:var(--brand-dark)}
    .actions{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:12px}
    .actions a{flex:1;text-decoration:none}
    .muted{opacity:.8;font-size:14px;text-align:center;margin-top:12px;color:var(--muted)}
  </style>
</head>
<body>
<header>üçï Mama's Pizza Shop</header>
<div class="container">
  <h2>Build Your Pizza Order</h2>

  <form id="orderForm" oninput="updateTotals()">
    <h3>How many pizzas?</h3>
    <input type="number" id="pizzaCount" name="pizzaCount" min="1" max="5" value="1" onchange="renderPizzas()" required>

    <div id="pizzaForms" class="grid"></div>

    <h3>Delivery Address</h3>
    <textarea name="address" id="address" rows="3" required placeholder="House / Street / City / Phone"></textarea>

    <h3>Coupon Code (optional)</h3>
    <input type="text" id="coupon" placeholder="Enter coupon code" oninput="updateTotals()">

    <div class="total" id="grandTotal">Total: ‚Çπ0</div>
    <input type="hidden" name="orderSummary" id="orderSummary">

    <div class="actions">
      <button type="button" class="btn" onclick="copyOrder()">üìã Copy Order</button>
      <a id="waLink" class="btn" target="_blank">üí¨ Send via WhatsApp</a>
    </div>
  </form>

  <p class="muted">Images needed in same folder:  
  <code>pizza-base.png</code>, <code>topping-cheese.png</code>, <code>topping-veg-few.png</code>, <code>topping-corn.png</code>, <code>topping-chicken-small.png</code>, <code>topping-olives.png</code></p>
</div>
<script>
/* ---------- CONFIG ---------- */
const PRICES = { Small:150, Medium:250, Large:350, topping:30 };
const COUPONS = { SAVE50:50, WELCOME10:0.10 };

const IMG = {
  base:    "pizza-base.png",
  cheese:  "topping-cheese.png",
  veg:     "topping-veg-few.png",
  corn:    "topping-corn.png",
  chicken: "topping-chicken-small.png",
  olives:  "topping-olives.png"   // NEW
};

// Cheese under everything else
const LAYER_ORDER = ["base","cheese","veg","corn","chicken","olives"];
const SIZE_DIM = { Small:180, Medium:240, Large:300 };

/* ---------- RENDER ---------- */
function renderPizzas(){
  const n=+document.getElementById('pizzaCount').value||1;
  const wrap=document.getElementById('pizzaForms');
  wrap.innerHTML="";
  for(let i=1;i<=n;i++){
    wrap.insertAdjacentHTML("beforeend", sectionHTML(i));
    drawLayers(i);
  }
  updateTotals();
}

function sectionHTML(i){
  return `
  <div class="pizza-section" id="pz${i}">
    <h4>Pizza ${i}</h4>
    <div class="preview-wrap">
      <div class="stage" id="stage${i}">
        ${LAYER_ORDER.map((layer, zi)=>`<img class="layer" style="z-index:${zi};" id="img_${i}_${layer}" alt="${layer}" />`).join("")}
      </div>
      <div class="controls">
        <label>Size:
          <select name="pizza${i}_size" required onchange="resizePizza(${i}, this.value); updateTotals()">
            <option value="">-- Select Size --</option>
            <option value="Small">Small (‚Çπ${PRICES.Small})</option>
            <option value="Medium">Medium (‚Çπ${PRICES.Medium})</option>
            <option value="Large">Large (‚Çπ${PRICES.Large})</option>
          </select>
        </label>

        <label><input type="checkbox" data-layer="cheese"  name="pizza${i}_toppings" value="Cheese" onchange="drawLayers(${i});updateTotals()"> Cheese (+‚Çπ${PRICES.topping})</label>
        <label><input type="checkbox" data-layer="veg"     name="pizza${i}_toppings" value="Vegetables" onchange="drawLayers(${i});updateTotals()"> Vegetables (+‚Çπ${PRICES.topping})</label>
        <label><input type="checkbox" data-layer="corn"    name="pizza${i}_toppings" value="Corn" onchange="drawLayers(${i});updateTotals()"> Corn (+‚Çπ${PRICES.topping})</label>
        <label><input type="checkbox" data-layer="chicken" name="pizza${i}_toppings" value="Chicken" onchange="drawLayers(${i});updateTotals()"> Chicken (+‚Çπ${PRICES.topping})</label>
        <label><input type="checkbox" data-layer="olives"  name="pizza${i}_toppings" value="Olives" onchange="drawLayers(${i});updateTotals()"> Olives (+‚Çπ${PRICES.topping})</label>
      </div>
    </div>
  </div>`;
}

/* ---------- PREVIEW ---------- */
function drawLayers(i){
  const stageId=id=>document.getElementById(`img_${i}_${id}`);
  const sizeSel=document.querySelector(`[name='pizza${i}_size']`);

  // base shows only if size chosen
  if(sizeSel && sizeSel.value){
    stageId("base").src=IMG.base;
    stageId("base").style.display="block";
    stageId("base").style.transform="scale(1.1)"; // üî• make base 10% bigger
  } else {
    stageId("base").removeAttribute("src");
    stageId("base").style.display="none";
  }

  // toppings
  const boxes=document.querySelectorAll(`#pz${i} [type="checkbox"]`);
  const active=new Set([...boxes].filter(b=>b.checked).map(b=>b.dataset.layer));
  ["cheese","veg","corn","chicken","olives"].forEach((layer,index)=>{
    const el=stageId(layer);
    if(active.has(layer)){
      el.src=IMG[layer];
      el.style.display="block";
      el.style.zIndex=index+1;
      el.style.transform="scale(0.8)"; // toppings stay normal size
    }
    else{
      el.removeAttribute("src");
      el.style.display="none";
    }
  });
}

function resizePizza(i, size){
  const stage=document.getElementById(`stage${i}`);
  if(size && SIZE_DIM[size]){
    stage.style.width=SIZE_DIM[size]+"px";
    stage.style.height=SIZE_DIM[size]+"px";
  } else {
    stage.style.width="0px"; // hide if size cleared
    stage.style.height="0px";
  }
  drawLayers(i);
}

/* ---------- TOTALS + WHATSAPP + COPY ---------- */
function updateTotals(){
  let n=+document.getElementById('pizzaCount').value||1;
  let total=0, summary=[];
  for(let i=1;i<=n;i++){
    const sizeSel=document.querySelector(`[name='pizza${i}_size']`);
    if(!sizeSel||!sizeSel.value) continue;
    let price=PRICES[sizeSel.value];
    const toppings=[...document.querySelectorAll(`#pz${i} [name='pizza${i}_toppings']:checked`)].map(b=>b.value);
    price+=PRICES.topping*toppings.length;
    total+=price;
    summary.push(`Pizza ${i}: ${sizeSel.value} + ${toppings.join(", ")||"No extra"} = ‚Çπ${price}`);
  }
  let coupon=document.getElementById("coupon").value.trim().toUpperCase();
  if(coupon && COUPONS[coupon]){
    if(COUPONS[coupon]<1){
      let disc=Math.round(total*COUPONS[coupon]);
      total-=disc; summary.push(`Coupon ${coupon}: -‚Çπ${disc}`);
    }else{
      total-=COUPONS[coupon];
      summary.push(`Coupon ${coupon}: -‚Çπ${COUPONS[coupon]}`);
    }
  }

  // include address if present
  const addr = document.getElementById('address').value.trim();
  if(addr) summary.push(`Address: ${addr}`);

  const finalSummary = summary.join("\n")+`\nTotal = ‚Çπ${total}`;
  document.getElementById('grandTotal').textContent=`Total: ‚Çπ${total}`;
  document.getElementById('orderSummary').value=finalSummary;

  // set WhatsApp link
  const wa = document.getElementById('waLink');
  if(wa) wa.href = "https://wa.me/917795402536?text=" + encodeURIComponent(finalSummary);

  return finalSummary;
}

function copyOrder(){
  const text = updateTotals();
  navigator.clipboard.writeText(text).then(()=>alert("Order copied!"));
}

/* init */
renderPizzas();
</script>
</body>
</html>
